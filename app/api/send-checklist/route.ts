import { NextResponse } from 'next/server';
import { sendComplexMessage } from '@/app/webhook-handlers/actions/sendComplexMessage';

export async function POST(req: Request) {
  try {
    const body = await req.json();
    const chatId = body?.chatId ?? body?.chat_id ?? null;

    if (!chatId) return NextResponse.json({ success: false }, { status: 400 });

    const checklist = [
      '*üè¥‚Äç‚ò†Ô∏è –ú–ê–ù–ò–§–ï–°–¢ –ê–ù–¢–ò-–®–¢–†–ê–§*',
      '–ö–∞–∫ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –∫–æ—Ä–º–∏—Ç—å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã —Å–≤–æ–µ–π –ø—Ä–∏–±—ã–ª—å—é.',
      '',
      '1. *–£–±–µ–π –§–∞–Ω—Ç–æ–º–æ–≤:* API-—Å–∏–Ω–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å < 5 –º–∏–Ω. –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —Å–∞–º–æ—É–±–∏–π—Å—Ç–≤–æ.',
      '2. *–õ–æ–≤—É—à–∫–∞ –í–æ–∑–≤—Ä–∞—Ç–æ–≤:* –§–∏–∑–∏—á–µ—Å–∫–∏ –æ—Ç–¥–µ–ª—è–π "–í–æ–∑–≤—Ä–∞—Ç—ã" –æ—Ç "–°—Ç–æ–∫–∞" –Ω–∞ –ø–æ–ª–∫–µ.',
      '3. *–ö–æ–Ω—Ç—Ä–æ–ª—å –¢–∞–π–º–∏–Ω–≥–∞:* –°—Ç–∞–≤—å –∞–ª–µ—Ä—Ç—ã –∑–∞ 2 —á–∞—Å–∞ –î–û –¥–µ–¥–ª–∞–π–Ω–∞ –æ—Ç–≥—Ä—É–∑–∫–∏.',
      '4. *–§–æ—Ç–æ-—Ñ–∏–∫—Å–∞—Ü–∏—è:* –°–Ω–∏–º–∞–π –ø—Ä–æ—Ü–µ—Å—Å —É–ø–∞–∫–æ–≤–∫–∏. –û—Å–ø–∞—Ä–∏–≤–∞–π —à—Ç—Ä–∞—Ñ—ã —Å –∂–µ–ª–µ–∑–Ω—ã–º–∏ –ø—Ä—É—Ñ–∞–º–∏.',
      '5. *–ü—Ä–∞–≤–∏–ª–æ 2 –ù–µ–¥–µ–ª—å:* –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –≤–æ–∑–≤—Ä–∞—Ç—ã –∫–∞–∂–¥—ã–µ 14 –¥–Ω–µ–π. –í—ã—á–∏—Å–ª—è–π –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ SKU –∑–∞—Ä–∞–Ω–µ–µ.',
      '6. *–°—Ç—Ä–∞—Ö–æ–≤–æ—á–Ω—ã–π –ë—É—Ñ–µ—Ä:* –î–µ—Ä–∂–∏ 5% "–ù–µ–≤–∏–¥–∏–º–æ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞", —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ–≤–µ—Ä—Å–µ–ª–ª–∏–Ω–≥–∞.',
      '7. *–ö—É–ª—å—Ç –°–∫–∞–Ω–µ—Ä–∞:* –ù–∏ –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä –Ω–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è –±–µ–∑ "–ø–∏–∫–∞". –ò—Å–∫–ª—é—á–µ–Ω–∏–π –Ω–µ—Ç.',
      '',
      'üöÄ *–ù—É–∂–µ–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –¥–µ–ª–∞–µ—Ç?* –ñ–º–∏ /start, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å WarehouseBot.'
    ].join('\n');

    await sendComplexMessage(chatId, checklist, [], { parseMode: 'Markdown' });

    return NextResponse.json({ success: true });
  } catch (err) {
    return NextResponse.json({ success: false }, { status: 500 });
  }
}